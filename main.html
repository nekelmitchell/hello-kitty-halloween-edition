<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Dress Up Hello Kitty</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

    :root {
      --window-w: 380px;
      --area-w: 300px;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: "Press Start 2P", sans-serif;
      text-align: center;
      background: url("spookybackground.jpg") no-repeat center center fixed;
      background-size: cover;
      color: white;
    }
    #preview-img {
     z-index: 10; /* ensures preview stays on top while selecting */
    }

    .game-window {
      background-color: #FFB62E;
      border-radius: 20px;
      width: var(--window-w);
      margin: 60px auto;
      padding: 16px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.5);
      border: 3px solid #FFA500;
    }

    .window-header {
      font-size: 12px;
      color: #000401;
      background-color: #629e6b;
      border-radius: 12px;
      padding: 8px;
      margin-bottom: 12px;
    }

    /* The game area will either show selector-screen or Hello Kitty with overlays */
    #game-area {
      position: relative;
      width: var(--area-w);
      height: 350px;
      margin: 0 auto;
      overflow: hidden;
      border-radius: 12px;
      border: 2px solid #FFA500;
      background-color: #FFDFAF; /* fallback while selector screens load */
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* Base + overlays (the actual Hello Kitty when not selecting) */
    .kitty-layer {
      position: absolute;
      top: 30%;
      left: 50%;
      transform: translate(-50%,-50%);
      width: var(--area-w);
      height: auto;
      image-rendering: pixelated;
      pointer-events: none;
    }

    /* Preview image shown during selection (centered) */
    #preview-img {
      position: absolute;
      top: 30%;
      left: 50%;
      transform: translate(-50%,-50%);
      width: var(--area-w);
      height: auto;
      image-rendering: pixelated;
      display: none; /* visible only during a selector stage */
    }

    /* The selector screen (your custom PNG) */
    #selector-screen {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      background-size: cover;
      background-position: center;
      display: none; /* shown in selector stages */
    }

    .buttons { margin-top: 14px; }

    button {
      background-color: #FFB62E;
      border: 2px solid #FFA500;
      border-radius: 10px;
      padding: 8px 12px;
      margin: 6px;
      color: #355E3B;
      font-family: "Press Start 2P", sans-serif;
      font-size: 10px;
      cursor: pointer;
      transition: all 0.12s;
    }

    button:hover { transform: scale(1.04); }

    .hidden { display: none !important; }

    /* Message overlay for final screen */
    #message-overlay {
      position: absolute;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      background: rgba(0,0,0,0.4);
      color: white;
      padding: 12px;
      text-align: center;
      flex-direction: column;
    }

    #message-overlay p { margin-bottom: 12px; font-size: 11px; }
  </style>
</head>
<body>

  <div class="game-window">
    <div class="window-header">Dress Up Hello Kitty</div>

    <div id="game-area">
      <!-- Selector screen (shows a user-provided PNG background when selecting a category) -->
      <div id="selector-screen"></div>

      <!-- Preview during selection -->
      <img id="preview-img" src="" alt="Preview">

      <!-- Hello Kitty base and overlays (hidden while selecting) -->
      <img id="base-img" class="kitty-layer" src="basehellokitty.png" alt="base">
      <img id="costume-img" class="kitty-layer" src="" alt="costume">


      <!-- Final message overlay -->
      <div id="message-overlay">
        <p id="message-text"></p>
        <button id="start-over-btn">Start Over</button>
      </div>
    </div>

    <!-- Navigation for browsing items in the current stage -->
    <div class="buttons" id="nav-buttons">
      <button id="back-btn">◀ Prev</button>
      <button id="confirm-btn">Yes, Done →</button>
      <button id="forward-btn">Next ▶</button>
    </div>

    <!-- (Optional) show what stage user is on -->
    <div style="margin-top:10px; font-size:10px; color:#2b2b2b;" id="stage-indicator"></div>
  </div>

<script>
  /*************** ASSETS ***************/
 const costumes = [
  "costumekitty1.png",
  "costumekitty2.png",
  "costumekitty3.png",
  "costumekitty4.png"
];


const stages = ["costume", "done"];

let currentIndices = { costume: 0 };

function getArrayForStage(stage) {
  if (stage === "costume") return costumes;
  return [];
}

  const selectorScreenEl = document.getElementById("selector-screen");
  const previewImg = document.getElementById("preview-img");
  const baseImg = document.getElementById("base-img");
  const costumeImg = document.getElementById("costume-img");
  const messageOverlay = document.getElementById("message-overlay");
  const messageText = document.getElementById("message-text");

  const backBtn = document.getElementById("back-btn");
  const forwardBtn = document.getElementById("forward-btn");
  const confirmBtn = document.getElementById("confirm-btn");
  const startOverBtn = document.getElementById("start-over-btn");
  const navButtons = document.getElementById("nav-buttons");
  const stageIndicator = document.getElementById("stage-indicator");

  /*************** HELPERS ***************/
  function getCurrentStage() {
    return stages[stageIndex];
  }

const selectorScreens = {
  costume: "costume_screen.png"
};


  function enterStage(index) {
    stageIndex = index;
    const stage = getCurrentStage();
    stageIndicator.textContent = `Step ${Math.min(stageIndex + 1, stages.length)} of ${stages.length}: ${stage}`;
    messageOverlay.style.display = "none";

    // If we reached the "done" stage, show final screen
    if (stage === "done") {
      selectorScreenEl.style.display = "none";
      previewImg.style.display = "none";
      showKitty();
      showFinalMessage();
      navButtons.classList.add("hidden");
      return;
    }

    // Show the Hello Kitty with all currently applied layers
    showKitty();

    // Display the background for the current selector screen
    const screenFile = selectorScreens[stage];
    selectorScreenEl.style.display = "block";
    selectorScreenEl.style.backgroundImage = screenFile ? `url("${screenFile}")` : "";

    // Show the preview image in front of everything
    previewImg.style.display = "block";
    previewImg.style.zIndex = "10";
    navButtons.classList.remove("hidden");

    const idx = currentIndices[stage] || 0;
    updatePreview(stage, idx);

    confirmBtn.textContent = (stageIndex === stages.length - 2) ? "Yes, Done" : "Yes, Done";
  }

  function updatePreview(stage, idx) {
    const arr = getArrayForStage(stage);
    if (!arr.length) return;
    idx = ((idx % arr.length) + arr.length) % arr.length;
    currentIndices[stage] = idx;
    previewImg.src = arr[idx];
  }

  function changePreview(direction) {
    const stage = getCurrentStage();
    if (stage === "done") return;
    const arr = getArrayForStage(stage);
    if (!arr.length) return;
    let idx = currentIndices[stage] || 0;
    idx = (idx + direction + arr.length) % arr.length;
    updatePreview(stage, idx);
  }

  function applyChoice(stage) {
  const idx = currentIndices[stage] || 0;
  const arr = getArrayForStage(stage);
  const chosen = arr[idx];
  if (!chosen) return;

  if (stage === "costume") costumeImg.src = chosen;
}


  function showKitty() {
  baseImg.style.display = "block";
  costumeImg.style.display = costumeImg.src ? "block" : "none";
}


  function showFinalMessage() {
    messageText.textContent = "Hooray! Hello Kitty is ready to Trick or Treat!";
    messageOverlay.style.display = "flex";
  }

  function startOver() {
  currentIndices = { costume: 0 };
  costumeImg.src = "";
  enterStage(0);
}


  /*************** EVENTS ***************/
  backBtn.addEventListener("click", () => changePreview(-1));
  forwardBtn.addEventListener("click", () => changePreview(1));

  confirmBtn.addEventListener("click", () => {
    const stage = getCurrentStage();
    if (stage === "done") return;

    // Apply the selected image to the correct layer
    applyChoice(stage);

    // Keep Kitty visible with the new choice
    showKitty();

    // Proceed to next stage
    setTimeout(() => enterStage(stageIndex + 1), 300);
  });

  startOverBtn.addEventListener("click", startOver);

  document.addEventListener("keydown", (e) => {
    const stage = getCurrentStage();
    if (stage === "done") return;
    if (e.key === "ArrowLeft") changePreview(-1);
    if (e.key === "ArrowRight") changePreview(1);
    if (e.key === "Enter") confirmBtn.click();
  });

  window.addEventListener("load", () => {
    baseImg.style.display = "block";
    enterStage(0);
  });
</script>


</body>
</html>
